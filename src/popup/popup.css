:root{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;--bg:#fff; --fg:#222; --muted:#777; --border:#e5e5e5; --accent:#0b74de; --chip:#f3f3f3;}
/* ручной выбор темы через data-theme на body */
body[data-theme="light"]{
  --bg:#fff; --fg:#222; --muted:#777; --border:#e5e5e5; --accent:#0b74de; --chip:#f3f3f3;
}
body[data-theme="dark"]{
  --bg:#15171a; --fg:#e9e9e9; --muted:#a0a0a0; --border:#2a2d31; --accent:#4da3ff; --chip:#23262a;
}
/* системная тема (когда атрибута нет) */
@media (prefers-color-scheme: dark){
  body:not([data-theme]) {
    --bg:#15171a; --fg:#e9e9e9; --muted:#a0a0a0; --border:#2a2d31; --accent:#4da3ff; --chip:#23262a;
  }
}
html,body,#root{margin:0;padding:0}
body{background:var(--bg);color:var(--fg)}
body.popup{width:360px;height:540px;overflow:hidden}
.app{display:flex;flex-direction:column;height:100vh;min-height:540px}
.topbar { display:flex; gap:.5rem; align-items:center; overflow-x:auto; flex-shrink:0; background: var(--bg); border-bottom:1px solid var(--border); padding:8px; }
.topitem { padding:.25rem .5rem; border-radius:.5rem; background:var(--bg-2); cursor:pointer; white-space:nowrap; position:relative; }
.topitem.active { background:var(--bg-3); font-weight:600; }
.top-actions { margin-left:.4rem; display:inline-flex; gap:.25rem; }
.topbar .add{margin-left:auto;border:0;background:var(--accent);color:#fff;border-radius:12px;padding:6px 10px;cursor:pointer;flex:0 0 auto}
.topbar button, .topbar select{border:1px solid var(--border);background:var(--bg);color:var(--fg);border-radius:8px;padding:6px 8px;flex:0 0 auto}
.main{padding:8px;overflow:auto;display:grid;grid-template-columns:1fr;gap:16px;flex:1;min-height:0}
@media (min-width: 900px){ .main{grid-template-columns:1.4fr 0.6fr} }
.card{border:1px solid var(--border);border-radius:12px;padding:10px}
.row{display:flex;gap:8px;align-items:center}
input[type='text'],select{flex:1;padding:6px 8px;border:1px solid var(--border);border-radius:8px;background:var(--bg);color:var(--fg)}
button{padding:6px 10px;border:1px solid var(--border);border-radius:8px;background:var(--bg);color:var(--fg);cursor:pointer}
.muted{color:var(--muted);font-size:12px}
.tree{padding:8px;overflow:auto;height:100%}
.tree-actions{
  display:flex;
  gap:8px;
  margin-bottom:8px;
  border-bottom:1px dashed var(--border);
  padding-bottom:8px;
  align-items:center;         /* важно: вертикальное выравнивание */
  position: relative; 
  z-index: 2;
}
.node{margin-left:8px}
.node-row{position:relative;display:flex;align-items:center;gap:6px;padding:2px 4px;border-radius:8px}
.node-row:hover{background:color-mix(in oklab,var(--accent) 8%,transparent)}
.children{position:relative;margin-left:16px;padding-left:16px}
.children::before{content:'';position:absolute;left:7px;top:0;bottom:0;border-left:1px solid var(--border)}
.node-row::before{content:'';position:absolute;left:-9px;top:12px;width:9px;border-top:1px solid var(--border)}
.node .children{transition:opacity 120ms ease,transform 120ms ease}
.node-row[aria-expanded='false'] + .children{opacity:0;transform:translateY(-4px)}
.dot{width:8px;height:8px;border-radius:50%}
.dot.folder{background:#888}.dot.link{background:var(--accent)}
.node-actions{margin-left:auto;display:flex;gap:6px}
.icon-btn { background:transparent; border:none; cursor:pointer; }
.favicon{width:16px;height:16px;border-radius:3px;flex:0 0 16px}
.link-wrap{display:flex;align-items:center;gap:6px;min-width:0}
.link-text{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.footer{
  flex-shrink:0;
  background: var(--bg);
  border-top:1px solid var(--border);
  padding: 8px 12px;
  display:flex;
  justify-content: space-between;
  align-items:center;
}
.footer button{ padding:6px 10px; }
.levels .level-btn{
  padding: 4px 8px;
  border:1px solid var(--border);
  border-radius: 8px;
  background: var(--bg);
  color: var(--fg);
  cursor: pointer;
  flex: 0 0 auto;             /* фиксированный размер кнопок */
}
.levels .level-btn.active{
  background: color-mix(in oklab, var(--accent) 12%, transparent);
  border-color: var(--accent);
  font-weight: 600;
}
/* ----- панель уровней ----- */
.levelbar {
  display: inline-flex;
  gap: 6px;
  align-items: center;
  margin-left: 8px;
  flex-wrap: wrap;
}
.levelbar .chip {
  border: 1px solid var(--border);
  background: var(--bg);
  color: var(--fg);
  border-radius: 999px;
  padding: 2px 8px;
  font-size: 12px;
  cursor: pointer;
}
.levelbar .chip.active {
  background: color-mix(in oklab, var(--accent) 18%, transparent);
  border-color: var(--accent);
}